function [ M, K, M1, K1 ] = getMatrices( m, l, I, E)
%GETMATRICES Summary of this function goes here
%   Detailed explanation goes here

M = zeros(8); K = zeros(8);
M1 = zeros(4); K1 = zeros(4);
%% stiffness matrix
K(1,1) = 1/2*12*E*I/l^3;
K(2,2) = K(1,1); K(5,5) = K(1,1); K(6,6) = K(1,1);

K(3,3) = 1/2*4*E*I/l;
K(4,4) = K(3,3); K(7,7) = K(3,3); K(8,8) = K(3,3);

K(3,2) = -6*E*I/l^2;
K(4,1) = -K(3,2); K(7,2) = K(3,2); K(8,1) = -K(3,2); 
                  K(5,4) = K(3,2); K(6,3) = -K(3,2); 
                  K(8,5) = K(3,2); K(7,6) = -K(3,2); 
                  
K(7,3) = 2*E*I/l; K(8,4) = K(7,3); 
                  
K(5,1) = -2*K(1,1); K(6,2) = -2*K(1,1);
K = K + K';
%% mass matrix
M(1,1) = 156/2; M(2,2) = M(1,1); M(5,5) = M(1,1); M(6,6) = M(1,1);

M(3,3) = 4*l^2/2; M(4,4) = M(3,3); M(7,7) = M(3,3); M(8,8) = M(3,3); 

M(4,1) = 22*l;   M(3,2) = -M(4,1); 

M(7,6) = M(4,1); M(8,5) = -M(4,1);

M(5,1) = 54; M(6,2) = M(5,1);

M(7,2) = 13*l;  M(8,1) = -M(7,2);
M(5,4) = M(7,2);M(6,3) = -M(7,2);

M(7,3) = -3*l^2; M(8,4) = M(7,3);

M = m/420*(M + M');

%% 1D matrices
M1(1,1) = 156/2;   M1(3,3) = 156/2;
M1(2,2) = 4*l^2/2; M1(4,4) = 4*l^2/2;
M1(2,1) = 22*l; M1(4,3) = -22*l;
M1(3,2) = 13*l; M1(4,1) = -13*l;
M1(3,1) = 54; 
M1(4,2) = -2*l^2;
M1 = M1 + M1';
M1 = m/420*M1;

K1(1,1) = 12/2;   K1(3,3) = 12/2;
K1(2,2) = 4*l^2/2; K1(4,4) = 4*l^2/2;
K1(2,1) = 6*l; K1(4,1) = 6*l;
K1(3,2) = -6*l; K1(4,3) = -6*l;
K1(3,1) = -12;
K1(4,2) = 2*l^2;
K1 = K1 + K1';
K1 = E*I/l^3*K1;

end