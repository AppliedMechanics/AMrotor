

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Simulation_file_example &mdash; AMrotor  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Laval_Time" href="../Laval_Time.html" />
    <link rel="prev" title="Config_file_example" href="Config_modal_Laval.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> AMrotor
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../Simple_Laval.html">Simple laval rotor example</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../Laval_Modal.html">Laval_Modal</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Config_modal_Laval.html">Config_file_example</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Simulation_file_example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Laval_Time.html">Laval_Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../MBTR_test_rig.html">MBTR test rig with spring damper elements as bearings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MBTR_test_rig_with_AMBs.html">MBTR test rig with AMB bearings</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Code Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_doc/doc_classes.html">doc_classes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">AMrotor</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../examples.html">Examples</a> &raquo;</li>
        
          <li><a href="../Simple_Laval.html">Simple laval rotor example</a> &raquo;</li>
        
          <li><a href="../Laval_Modal.html">Laval_Modal</a> &raquo;</li>
        
      <li>Simulation_file_example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/examples/Laval_Modal/Simulation_modal_Laval.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="simulation-file-example">
<h1>Simulation_file_example<a class="headerlink" href="#simulation-file-example" title="Permalink to this headline">Â¶</a></h1>
<p>This is an example code for a simulation file of a simple Laval rotor for system analyses.
All the code snippets can be copied and pasted together in a Matlab script and executed
directly. The hidden (commented out) code parts should show further possibilities.
The presented functions often contain options that cannot all be shown in the examples.
More options can be found in the detailed documentation or in the source code.</p>
<p>Closing all former figures and cleaning the workspace.</p>
<div class="highlight-matlab notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">close</span> <span class="s">all</span>
<span class="n">clear</span> <span class="s">all</span>
<span class="c">% clc</span>
</pre></div>
</td></tr></table></div>
<p>Import of the file path and  of the corresponding cnfg-file.</p>
<div class="highlight-matlab notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">%% Import and formating of the figures</span>

<span class="n">import</span> <span class="s">AMrotorSIM.*</span> <span class="s">%</span> <span class="s">path</span>
<span class="n">Config_Sim_Modal</span> <span class="s">%</span> <span class="s">corresponding</span> <span class="s">cnfg-file</span>

<span class="n">Janitor</span> <span class="p">=</span> <span class="n">AMrotorTools</span><span class="p">.</span><span class="n">PlotJanitor</span><span class="p">();</span> <span class="c">% Instantiation of class PlotJanitor</span>
<span class="n">Janitor</span><span class="p">.</span><span class="n">setLayout</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="c">%Setting layout of the figures</span>
</pre></div>
</td></tr></table></div>
<p>Assembly and visualization of the model</p>
<div class="highlight-matlab notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">%% Assembly of the rotordynamic model</span>

<span class="n">r</span><span class="p">=</span><span class="n">Rotorsystem</span><span class="p">(</span><span class="n">cnfg</span><span class="p">,</span><span class="s">&#39;Laval-Rotor&#39;</span><span class="p">);</span> <span class="c">% Instantiation of class Rotorsystem</span>
<span class="n">r</span><span class="p">.</span><span class="n">assemble</span><span class="p">;</span> <span class="c">% assembly of the model parts, considering the ...</span>
            <span class="c">% components (sensors,..) from the cnfg-file</span>
<span class="n">r</span><span class="p">.</span><span class="n">rotor</span><span class="p">.</span><span class="n">assemble_fem</span><span class="p">;</span> <span class="c">% assembly of the global system matrices: M, D, G, K</span>

<span class="c">%% Visualization of the assembled rotor model</span>

<span class="n">r</span><span class="p">.</span><span class="n">show</span><span class="p">;</span> <span class="c">% lists the associated components of the model in teh Matlab ...</span>
        <span class="c">% Command Window</span>
        
<span class="n">r</span><span class="p">.</span><span class="n">rotor</span><span class="p">.</span><span class="n">show_2D</span><span class="p">();</span> <span class="c">% Plot of a side view of the rotor elements</span>
<span class="c">% r.rotor.geometry.show_2D();  % Plot of a side view of the ..</span>
                               <span class="c">% rotor radii</span>
<span class="c">% r.rotor.geometry.show_3D(); % Plot of a 3D-isometry of the rotor</span>
<span class="c">% r.rotor.mesh.show_2D(); </span>
<span class="c">% r.rotor.mesh.show_2D_nodes(); </span>
<span class="c">% r.rotor.mesh.show_3D();</span>

<span class="n">g</span><span class="p">=</span><span class="n">Graphs</span><span class="p">.</span><span class="n">Visu_Rotorsystem</span><span class="p">(</span><span class="n">r</span><span class="p">);</span> <span class="c">% Instantiation of class Visu_Rotorsystem</span>
<span class="n">g</span><span class="p">.</span><span class="n">show</span><span class="p">();</span> <span class="c">% Plot of a 3D-isometry of the rotor with sensors, loads,...</span>

<span class="n">u_trans_rigid_body</span> <span class="p">=</span> <span class="n">r</span><span class="p">.</span><span class="n">compute_translational_rigid_body_modes</span><span class="p">;</span> <span class="c">% Locates ..</span>
                         <span class="c">% the translational DoF&#39;s of the rotor in a matrix</span>
<span class="n">overall_mass</span> <span class="p">=</span> <span class="n">r</span><span class="p">.</span><span class="n">check_overall_translational_mass</span><span class="p">(</span><span class="n">u_trans_rigid_body</span><span class="p">)</span> <span class="c">% ...</span>
                         <span class="c">% Calculates the translational mass</span>
</pre></div>
</td></tr></table></div>
<p>2D side view of the rotor (left) and 3D-isometry (right)</p>
<a class="reference internal image-reference" href="../../_images/Rotor_geometry.png"><img alt="../../_images/Rotor_geometry.png" src="../../_images/Rotor_geometry.png" style="width: 48%;" /></a>
<a class="reference internal image-reference" href="../../_images/Rotor_geometry_3D.png"><img alt="../../_images/Rotor_geometry_3D.png" src="../../_images/Rotor_geometry_3D.png" style="width: 48%;" /></a>
<p>Determination of the results (FRF, Campbell, Modal analysis) and their visualization</p>
<div class="highlight-matlab notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">%% Running system analyses</span>
<span class="c">%% Frequency response function</span>

<span class="n">frf</span><span class="p">=</span><span class="n">Experiments</span><span class="p">.</span><span class="n">Frequenzgangfunktion</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="s">&#39;FRF&#39;</span><span class="p">);</span> <span class="c">% Instantiation of ... </span>
                        <span class="c">% class Frequenzgangfunktion</span>
<span class="n">type</span> <span class="p">=</span> <span class="s">&#39;d&#39;</span><span class="p">;</span> <span class="c">% FRF type: displ. &#39;d&#39;, veloc. &#39;v&#39;, accel. &#39;a&#39;</span>
<span class="n">inPos</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">;</span> <span class="c">% Input positions on the rotor axis</span>
<span class="n">outPos</span> <span class="p">=</span> <span class="mf">100e-3</span><span class="p">;</span> <span class="c">% Output positions along the rotor axis</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">100</span><span class="p">;</span> <span class="c">% Frequency resolution of the FRF</span>
<span class="n">rpm</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c">% Rotational speed</span>
<span class="p">[</span><span class="n">f</span><span class="p">,</span><span class="n">H</span><span class="p">]=</span><span class="n">frf</span><span class="p">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">inPos</span><span class="p">,</span><span class="n">outPos</span><span class="p">,</span><span class="n">type</span><span class="p">,</span><span class="n">rpm</span><span class="p">,{</span><span class="s">&#39;u_x&#39;</span><span class="p">,</span><span class="s">&#39;u_y&#39;</span><span class="p">,</span><span class="s">&#39;psi_x&#39;</span><span class="p">},</span> <span class="k">...</span><span class="c"> </span>
    <span class="p">{</span><span class="s">&#39;u_x&#39;</span><span class="p">,</span><span class="s">&#39;psi_x&#39;</span><span class="p">});</span> <span class="c">% Calculation of the FRF&#39;s from the three input ... </span>
                      <span class="c">% directions {&#39;u_x&#39;,&#39;u_y&#39;,&#39;psi_x&#39;} to the two ... </span>
                      <span class="c">% output directions {&#39;u_x&#39;,&#39;psi_x&#39;} at the ...</span>
                      <span class="c">% corresponding positions</span>
<span class="p">[</span><span class="n">deltaIn</span><span class="p">,</span><span class="n">deltaOut</span><span class="p">]=</span><span class="n">frf</span><span class="p">.</span><span class="n">print_distance_delta</span><span class="p">;</span> <span class="c">% Plot of the gap between ...</span>
                      <span class="c">% the desired positions along the rotor axis and ...</span>
                      <span class="c">% the closest node position in the Command Window.</span>

<span class="n">visufrf</span> <span class="p">=</span> <span class="n">Graphs</span><span class="p">.</span><span class="n">Frequenzgangfunktion</span><span class="p">(</span><span class="n">frf</span><span class="p">);</span> <span class="c">% Instantiation of ... </span>
                        <span class="c">% class Frequenzgangfunktion for figures</span>
<span class="n">visufrf</span><span class="p">.</span><span class="n">set_plots</span><span class="p">(</span><span class="s">&#39;amplitude&#39;</span><span class="p">,</span><span class="s">&#39;db&#39;</span><span class="p">)</span> <span class="c">% Amplitude plot of all FRF&#39;s</span>
<span class="n">visufrf</span><span class="p">.</span><span class="n">set_plots</span><span class="p">(</span><span class="s">&#39;phase&#39;</span><span class="p">,</span><span class="s">&#39;db&#39;</span><span class="p">)</span> <span class="c">% Phase plot of all FRF&#39;s</span>
<span class="n">visufrf</span><span class="p">.</span><span class="n">set_plots</span><span class="p">(</span><span class="s">&#39;bode&#39;</span><span class="p">,</span><span class="s">&#39;log&#39;</span><span class="p">,</span><span class="s">&#39;deg&#39;</span><span class="p">)</span> <span class="c">% Bode plot of all FRF&#39;s</span>
<span class="n">visufrf</span><span class="p">.</span><span class="n">set_plots</span><span class="p">(</span><span class="s">&#39;nyquist&#39;</span><span class="p">)</span> <span class="c">% Nyquist plot of all FRF&#39;s</span>
<span class="n">Janitor</span><span class="p">.</span><span class="n">cleanFigures</span><span class="p">();</span> <span class="c">% Formating of the figures</span>

<span class="c">%% Modal analysis</span>

<span class="n">m</span><span class="p">=</span><span class="n">Experiments</span><span class="p">.</span><span class="n">Modalanalyse</span><span class="p">(</span><span class="n">r</span><span class="p">);</span> <span class="c">% Instantiation of ... </span>
                        <span class="c">% class Modalanalyse</span>
<span class="n">m</span><span class="p">.</span><span class="n">calculate_rotorsystem</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mf">3e3</span><span class="p">);</span> <span class="c">% Calcualtion (#modes,rpm)</span>

<span class="n">esf</span><span class="p">=</span><span class="n">Graphs</span><span class="p">.</span><span class="n">Eigenschwingformen</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="c">% Instantiation of ... </span>
                        <span class="c">% class Eigenschwingformen</span>
<span class="n">esf</span><span class="p">.</span><span class="n">print_frequencies</span><span class="p">();</span> <span class="c">% Print of the eigenfrequencies ...</span>
                         <span class="c">% with the corresponding modal damping ...</span>
                         <span class="c">% in the Command Window</span>
<span class="n">esf</span><span class="p">.</span><span class="n">plot_displacements</span><span class="p">();</span> <span class="c">% Figures of the eigenmodes ... </span>
                          <span class="c">% in specific directions</span>
<span class="n">esf</span><span class="p">.</span><span class="n">set_plots</span><span class="p">(</span><span class="s">&#39;half&#39;</span><span class="p">,</span><span class="s">&#39;Overlay&#39;</span><span class="p">)</span> <span class="c">% Plots of the odd-numbered eigenmodes ... </span>
                                <span class="c">% in overlay with the original rotor</span>
<span class="n">Janitor</span><span class="p">.</span><span class="n">cleanFigures</span><span class="p">();</span> <span class="c">% Formating of the figures</span>


<span class="c">%% Campbell diagramm</span>

<span class="n">cmp</span> <span class="p">=</span> <span class="n">Experiments</span><span class="p">.</span><span class="n">Campbell</span><span class="p">(</span><span class="n">r</span><span class="p">);</span> <span class="c">% Instantiation of ... </span>
                        <span class="c">% class Campbell</span>
<span class="n">cmp</span><span class="p">.</span><span class="n">set_up</span><span class="p">(</span><span class="mf">1e2</span><span class="p">:</span><span class="mf">1e2</span><span class="p">:</span><span class="mf">10e3</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span> <span class="c">% Set_up (omega range in 1/min, #modes)</span>
<span class="n">cmp</span><span class="p">.</span><span class="n">calculate</span><span class="p">();</span> <span class="c">% Calculation</span>

<span class="n">cmpDiagramm</span> <span class="p">=</span> <span class="n">Graphs</span><span class="p">.</span><span class="n">Campbell</span><span class="p">(</span><span class="n">cmp</span><span class="p">);</span> <span class="c">% Instantiation of ... </span>
                        <span class="c">% class Campbell for figures</span>
<span class="n">cmpDiagramm</span><span class="p">.</span><span class="n">print_damping_zero_crossing</span><span class="p">();</span> <span class="c">% Prints in the Command Window</span>
<span class="n">cmpDiagramm</span><span class="p">.</span><span class="n">print_critical_speeds</span><span class="p">()</span> <span class="c">% Prints in the Command Window</span>
<span class="n">cmpDiagramm</span><span class="p">.</span><span class="n">set_plots</span><span class="p">(</span><span class="s">&#39;all&#39;</span><span class="p">);</span> <span class="c">% Figures</span>
<span class="c">% cmpDiagramm.set_plots(&#39;backward&#39;);</span>
<span class="c">% cmpDiagramm.set_plots(&#39;forward&#39;);</span>
<span class="n">Janitor</span><span class="p">.</span><span class="n">cleanFigures</span><span class="p">();</span> <span class="c">% Formating of the figures</span>
</pre></div>
</td></tr></table></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Laval_Time.html" class="btn btn-neutral float-right" title="Laval_Time" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Config_modal_Laval.html" class="btn btn-neutral float-left" title="Config_file_example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, AMrotor_Team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>